<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fuel Consumption Calculator</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: #121212;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        background: #1e1e1e;
        border-radius: 10px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        padding: 40px;
        max-width: 600px;
        width: 100%;
      }

      h1 {
        text-align: center;
        color: rgba(255, 255, 255, 0.87);
        margin-bottom: 30px;
        font-size: 28px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: rgba(255, 255, 255, 0.87);
        font-weight: 600;
        font-size: 14px;
      }

      input[type="time"],
      input[type="number"],
      select {
        width: 100%;
        padding: 12px;
        border: 2px solid rgba(255, 255, 255, 0.12);
        border-radius: 5px;
        font-size: 14px;
        background: rgba(255, 255, 255, 0.05);
        color: rgba(255, 255, 255, 0.87);
        transition: border-color 0.3s;
      }

      input[type="time"]:focus,
      input[type="number"]:focus,
      select:focus {
        outline: none;
        border-color: #667eea;
        background: rgba(255, 255, 255, 0.08);
      }

      .row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      button {
        width: 100%;
        padding: 14px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 20px;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      .results {
        background: rgba(255, 255, 255, 0.08);
        border-left: 4px solid #667eea;
        padding: 20px;
        border-radius: 5px;
        margin-top: 30px;
        display: none;
      }

      .results.show {
        display: block;
      }

      .result-item {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.12);
      }

      .result-item:last-child {
        border-bottom: none;
      }

      .result-label {
        color: rgba(255, 255, 255, 0.6);
        font-weight: 600;
      }

      .result-value {
        color: rgba(255, 255, 255, 0.87);
        font-weight: 700;
        font-size: 16px;
      }

      .error {
        background: rgba(220, 53, 69, 0.15);
        color: #ff6b6b;
        padding: 12px;
        border-radius: 5px;
        margin-bottom: 20px;
        display: none;
        font-size: 14px;
      }

      .error.show {
        display: block;
      }

      .history {
        margin-top: 30px;
        border-top: 2px solid rgba(255, 255, 255, 0.12);
        padding-top: 20px;
      }

      .history h3 {
        color: rgba(255, 255, 255, 0.87);
        font-size: 16px;
        margin-bottom: 15px;
      }

      .history-item {
        background: rgba(255, 255, 255, 0.08);
        padding: 12px;
        border-radius: 5px;
        margin-bottom: 10px;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.6);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .history-item .info {
        flex: 1;
      }

      .history-item .info strong {
        color: rgba(255, 255, 255, 0.87);
      }

      .delete-btn {
        background: #d32f2f;
        color: rgba(255, 255, 255, 0.87);
        border: none;
        padding: 6px 12px;
        border-radius: 3px;
        cursor: pointer;
        font-size: 12px;
        margin-left: 10px;
      }

      .delete-btn:hover {
        background: #b71c1c;
      }

      .clear-history-btn {
        background: rgba(255, 255, 255, 0.12);
        width: 100%;
        margin-top: 10px;
        padding: 10px;
        font-size: 14px;
        color: rgba(255, 255, 255, 0.87);
      }

      .clear-history-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>â›½ Fuel Consumption Calculator</h1>

      <div class="error" id="error"></div>

      <div class="form-group">
        <label for="operator">Operator / Vehicle / Equipment</label>
        <select id="operator">
          <option value="">-- Select or Enter Name --</option>
          <option value="Motorbike">Motorbike</option>
          <option value="Vehicle">Vehicle</option>
          <option value="Generator">Generator</option>
          <option value="Bwoye Charles">Bwoye Charles</option>
          <option value="other">Other (Enter below)</option>
        </select>
        <input
          type="text"
          id="customOperator"
          placeholder="Enter operator/vehicle name"
          style="display: none; margin-top: 10px"
        />
      </div>

      <div class="row">
        <div class="form-group">
          <label for="startTime">Start Time</label>
          <input type="time" id="startTime" required />
        </div>
        <div class="form-group">
          <label for="endTime">End Time</label>
          <input type="time" id="endTime" required />
        </div>
      </div>

      <div class="form-group">
        <label for="liters">Liters Used</label>
        <input
          type="number"
          id="liters"
          placeholder="Enter amount in liters"
          min="0"
          step="0.01"
          required
        />
      </div>

      <button onclick="calculateConsumption()">Calculate Consumption</button>

      <div class="results" id="results">
        <div class="result-item">
          <span class="result-label">Operator/Vehicle:</span>
          <span class="result-value" id="resultOperator">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Start Time:</span>
          <span class="result-value" id="resultStart">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">End Time:</span>
          <span class="result-value" id="resultEnd">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Total Hours:</span>
          <span class="result-value" id="resultHours">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Liters Used:</span>
          <span class="result-value" id="resultLiters">-</span>
        </div>
        <div
          class="result-item"
          style="
            background: #e8f4f8;
            padding: 10px;
            margin: 10px -20px -20px -20px;
            border-bottom: none;
          "
        >
          <span class="result-label">Consumption (L/h):</span>
          <span
            class="result-value"
            style="color: #667eea"
            id="resultConsumption"
            >-</span
          >
        </div>
      </div>

      <div class="history" id="historySection" style="display: none">
        <h3>ðŸ“Š Calculation History</h3>
        <div id="historyList"></div>
        <button class="clear-history-btn" onclick="clearHistory()">
          Clear History
        </button>
      </div>
    </div>

    <script>
      const operatorSelect = document.getElementById("operator");
      const customOperatorInput = document.getElementById("customOperator");

      // Show/hide custom input
      operatorSelect.addEventListener("change", function () {
        if (this.value === "other") {
          customOperatorInput.style.display = "block";
          customOperatorInput.focus();
        } else {
          customOperatorInput.style.display = "none";
        }
      });

      function showError(message) {
        const errorDiv = document.getElementById("error");
        errorDiv.textContent = message;
        errorDiv.classList.add("show");
        setTimeout(() => {
          errorDiv.classList.remove("show");
        }, 4000);
      }

      function calculateConsumption() {
        const startTime = document.getElementById("startTime").value;
        const endTime = document.getElementById("endTime").value;
        const liters = parseFloat(document.getElementById("liters").value);
        let operator = operatorSelect.value;

        if (operator === "other") {
          operator = customOperatorInput.value.trim();
        }

        // Validation
        if (!startTime || !endTime) {
          showError("Please enter both start and end times");
          return;
        }

        if (!operator || operator === "") {
          showError("Please select or enter an operator/vehicle");
          return;
        }

        if (isNaN(liters) || liters <= 0) {
          showError("Please enter a valid amount of liters");
          return;
        }

        // Parse times
        const [startHour, startMin] = startTime.split(":").map(Number);
        const [endHour, endMin] = endTime.split(":").map(Number);

        const startMinutes = startHour * 60 + startMin;
        let endMinutes = endHour * 60 + endMin;

        // Handle case where end time is next day
        if (endMinutes <= startMinutes) {
          endMinutes += 24 * 60;
        }

        const totalMinutes = endMinutes - startMinutes;
        const totalHours = (totalMinutes / 60).toFixed(2);
        const consumption = (liters / totalHours).toFixed(2);

        // Display results
        document.getElementById("resultOperator").textContent = operator;
        document.getElementById("resultStart").textContent = startTime;
        document.getElementById("resultEnd").textContent = endTime;
        document.getElementById("resultHours").textContent =
          `${totalHours} hrs`;
        document.getElementById("resultLiters").textContent = `${liters} L`;
        document.getElementById("resultConsumption").textContent =
          `${consumption} L/h`;

        document.getElementById("results").classList.add("show");

        // Save to history
        addToHistory({
          operator: operator,
          startTime: startTime,
          endTime: endTime,
          totalHours: totalHours,
          liters: liters,
          consumption: consumption,
          timestamp: new Date().toLocaleString(),
        });
      }

      function addToHistory(record) {
        let history = JSON.parse(localStorage.getItem("fuelHistory") || "[]");
        history.unshift(record);

        // Keep only last 20 records
        if (history.length > 20) {
          history = history.slice(0, 20);
        }

        localStorage.setItem("fuelHistory", JSON.stringify(history));
        displayHistory();
      }

      function displayHistory() {
        const history = JSON.parse(localStorage.getItem("fuelHistory") || "[]");
        const historySection = document.getElementById("historySection");
        const historyList = document.getElementById("historyList");

        if (history.length === 0) {
          historySection.style.display = "none";
          return;
        }

        historySection.style.display = "block";
        historyList.innerHTML = history
          .map(
            (record, index) => `
                <div class="history-item">
                    <div class="info">
                        <strong>${record.operator}</strong> | ${record.startTime} - ${record.endTime}<br>
                        ${record.totalHours} hrs | ${record.liters} L | <strong>${record.consumption} L/h</strong>
                    </div>
                    <button class="delete-btn" onclick="deleteHistoryItem(${index})">Delete</button>
                </div>
            `,
          )
          .join("");
      }

      function deleteHistoryItem(index) {
        let history = JSON.parse(localStorage.getItem("fuelHistory") || "[]");
        history.splice(index, 1);
        localStorage.setItem("fuelHistory", JSON.stringify(history));
        displayHistory();
      }

      function clearHistory() {
        if (confirm("Are you sure you want to delete all history?")) {
          localStorage.removeItem("fuelHistory");
          displayHistory();
        }
      }

      // Allow Enter key to submit
      document.addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          calculateConsumption();
        }
      });

      // Load history on page load
      displayHistory();
    </script>
  </body>
</html>
